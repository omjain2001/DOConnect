{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _readOnlyError from \"@babel/runtime/helpers/readOnlyError\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { auth, firestore, storage } from \"../../auth/firebase\";\nimport { SET_USER, SET_USER_TYPE, FETCH_HOSPITAL_DATA, SET_ERROR, SET_ISLOADING, COLLECTION, USER_TYPE } from \"../constants\";\nexport var fetchUser = function fetchUser(email, userType) {\n  return function _callee(dispatch) {\n    var getUser, userData, profileImgUrl, hospitalData;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            dispatch({\n              type: SET_ISLOADING,\n              payload: true\n            });\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(firestore.collection(userType.toLowerCase() === USER_TYPE.DOCTOR.toLowerCase() ? COLLECTION.DOCTOR : COLLECTION.PATIENT).where(\"email\", \"==\", email).get());\n\n          case 4:\n            getUser = _context.sent;\n\n            if (!(getUser.docs.length > 0)) {\n              _context.next = 17;\n              break;\n            }\n\n            userData = getUser.docs[0].data();\n            profileImgUrl = \"\";\n\n            if (userData.profileImg) {\n              storage.ref(userData.profileImg).getDownloadURL().then(function (url) {\n                url, _readOnlyError(\"profileImgUrl\");\n              });\n            }\n\n            dispatch({\n              type: SET_USER,\n              payload: _objectSpread(_objectSpread({}, userData), {}, {\n                profileImg: profileImgUrl\n              })\n            });\n\n            if (!(userType.toLowerCase() === USER_TYPE.DOCTOR.toLowerCase())) {\n              _context.next = 15;\n              break;\n            }\n\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(firestore.collection(COLLECTION.HOSPITAL).doc(getUser.docs[0].data().hospitalRef).get());\n\n          case 13:\n            hospitalData = _context.sent;\n\n            if (hospitalData.exists) {\n              dispatch({\n                type: FETCH_HOSPITAL_DATA,\n                payload: hospitalData.data()\n              });\n            }\n\n          case 15:\n            dispatch({\n              type: SET_ISLOADING,\n              payload: false\n            });\n            return _context.abrupt(\"return\", new Promise(function (res) {\n              res({\n                status: \"success\",\n                message: \"Data fetched successfully\",\n                data: getUser.docs[0].data()\n              });\n            }));\n\n          case 17:\n            _context.next = 22;\n            break;\n\n          case 19:\n            _context.prev = 19;\n            _context.t0 = _context[\"catch\"](0);\n            return _context.abrupt(\"return\", new Promise(function (res, rej) {\n              rej({\n                status: \"error\",\n                message: _context.t0.message\n              });\n            }));\n\n          case 22:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 19]], Promise);\n  };\n};\nexport var uploadAvatar = function uploadAvatar(uri) {\n  return function _callee2(dispatch) {\n    var fileRef, avatarUrl;\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            fileRef = storage.child(uri);\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(fileRef.putString(uri));\n\n          case 3:\n            _context2.next = 5;\n            return _regeneratorRuntime.awrap(fileRef.getDownloadURL());\n\n          case 5:\n            avatarUrl = _context2.sent;\n            dispatch({\n              type: UPLOAD_AVATAR,\n              payload: avatarUrl\n            });\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var setUser = function setUser(user) {\n  return function _callee3(dispatch) {\n    return _regeneratorRuntime.async(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n\n            if (!(getState().auth.userType === USER_TYPE.DOCTOR)) {\n              _context3.next = 6;\n              break;\n            }\n\n            _context3.next = 4;\n            return _regeneratorRuntime.awrap(firestore.collection(COLLECTION.DOCTOR).doc(getState().auth.user.id).set(user, {\n              merge: true\n            }));\n\n          case 4:\n            _context3.next = 8;\n            break;\n\n          case 6:\n            _context3.next = 8;\n            return _regeneratorRuntime.awrap(firestore.collection(COLLECTION.PATIENT).doc(getState().auth.user.id).set(user, {\n              merge: true\n            }));\n\n          case 8:\n            dispatch({\n              type: SET_USER,\n              payload: user\n            });\n            return _context3.abrupt(\"return\", new Promise(function (res) {\n              return res({\n                status: \"success\",\n                message: \"Profile updated successfully\"\n              });\n            }));\n\n          case 12:\n            _context3.prev = 12;\n            _context3.t0 = _context3[\"catch\"](0);\n            dispatch({\n              type: SET_ERROR,\n              payload: _context3.t0.message\n            });\n            return _context3.abrupt(\"return\", new Promise(function (res) {\n              return res({\n                status: \"error\",\n                message: _context3.t0.message\n              });\n            }));\n\n          case 16:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[0, 12]], Promise);\n  };\n};\nexport var setUserType = function setUserType(type) {\n  return function (dispatch, getState) {\n    dispatch({\n      type: SET_USER_TYPE,\n      payload: type\n    });\n  };\n};\nexport var setUserState = function setUserState(user) {\n  return function (dispatch) {\n    dispatch({\n      type: SET_USER,\n      payload: user\n    });\n  };\n};\nexport var fetchHospitalData = function fetchHospitalData(UID) {\n  return function _callee4(dispatch) {\n    var getHospital;\n    return _regeneratorRuntime.async(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            dispatch({\n              type: SET_ISLOADING,\n              payload: true\n            });\n            _context4.next = 4;\n            return _regeneratorRuntime.awrap(firestore.collection(\"hospitals\").where(\"UID\", \"==\", UID).get());\n\n          case 4:\n            getHospital = _context4.sent;\n\n            if (!(getHospital.size === 1)) {\n              _context4.next = 10;\n              break;\n            }\n\n            getHospital.forEach(function (doc) {\n              dispatch({\n                type: FETCH_HOSPITAL_DATA,\n                payload: _objectSpread({\n                  id: doc.id\n                }, doc.data())\n              });\n            });\n            return _context4.abrupt(\"return\", new Promise(function (res) {\n              return res({\n                status: \"success\",\n                message: \"Hospital details fetched successfully\"\n              });\n            }));\n\n          case 10:\n            return _context4.abrupt(\"return\", new Promise(function (res, rej) {\n              return rej({\n                status: \"error\",\n                message: \"Hospital does not exist\"\n              });\n            }));\n\n          case 11:\n            _context4.next = 16;\n            break;\n\n          case 13:\n            _context4.prev = 13;\n            _context4.t0 = _context4[\"catch\"](0);\n            return _context4.abrupt(\"return\", new Promise(function (res, rej) {\n              return rej({\n                status: \"error\",\n                message: _context4.t0.message\n              });\n            }));\n\n          case 16:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[0, 13]], Promise);\n  };\n};","map":{"version":3,"sources":["D:/Web dev/DOConnect/app/redux/actions/authActions.js"],"names":["auth","firestore","storage","SET_USER","SET_USER_TYPE","FETCH_HOSPITAL_DATA","SET_ERROR","SET_ISLOADING","COLLECTION","USER_TYPE","fetchUser","email","userType","dispatch","type","payload","collection","toLowerCase","DOCTOR","PATIENT","where","get","getUser","docs","length","userData","data","profileImgUrl","profileImg","ref","getDownloadURL","then","url","HOSPITAL","doc","hospitalRef","hospitalData","exists","Promise","res","status","message","rej","uploadAvatar","uri","fileRef","child","putString","avatarUrl","UPLOAD_AVATAR","setUser","user","getState","id","set","merge","setUserType","setUserState","fetchHospitalData","UID","getHospital","size","forEach"],"mappings":"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","sourcesContent":["import { auth, firestore, storage } from \"../../auth/firebase\";\r\nimport {\r\n  SET_USER,\r\n  SET_USER_TYPE,\r\n  FETCH_HOSPITAL_DATA,\r\n  SET_ERROR,\r\n  SET_ISLOADING,\r\n  COLLECTION,\r\n  USER_TYPE,\r\n} from \"../constants\";\r\n\r\n// Fetching user details and hospital details (if user is doctor)\r\nexport const fetchUser = (email, userType) => async (dispatch) => {\r\n  try {\r\n    dispatch({\r\n      type: SET_ISLOADING,\r\n      payload: true,\r\n    });\r\n    const getUser = await firestore\r\n      .collection(\r\n        userType.toLowerCase() === USER_TYPE.DOCTOR.toLowerCase()\r\n          ? COLLECTION.DOCTOR\r\n          : COLLECTION.PATIENT\r\n      )\r\n      .where(\"email\", \"==\", email)\r\n      .get();\r\n\r\n    if (getUser.docs.length > 0) {\r\n      const userData = getUser.docs[0].data();\r\n      const profileImgUrl = \"\";\r\n\r\n      if (userData.profileImg) {\r\n        storage\r\n          .ref(userData.profileImg)\r\n          .getDownloadURL()\r\n          .then((url) => {\r\n            profileImgUrl = url;\r\n          });\r\n      }\r\n\r\n      dispatch({\r\n        type: SET_USER,\r\n        payload: {\r\n          ...userData,\r\n          profileImg: profileImgUrl,\r\n        },\r\n      });\r\n\r\n      if (userType.toLowerCase() === USER_TYPE.DOCTOR.toLowerCase()) {\r\n        const hospitalData = await firestore\r\n          .collection(COLLECTION.HOSPITAL)\r\n          .doc(getUser.docs[0].data().hospitalRef)\r\n          .get();\r\n        if (hospitalData.exists) {\r\n          dispatch({\r\n            type: FETCH_HOSPITAL_DATA,\r\n            payload: hospitalData.data(),\r\n          });\r\n        }\r\n      }\r\n\r\n      dispatch({\r\n        type: SET_ISLOADING,\r\n        payload: false,\r\n      });\r\n\r\n      return new Promise((res) => {\r\n        res({\r\n          status: \"success\",\r\n          message: \"Data fetched successfully\",\r\n          data: getUser.docs[0].data(),\r\n        });\r\n      });\r\n    }\r\n  } catch (error) {\r\n    return new Promise((res, rej) => {\r\n      rej({\r\n        status: \"error\",\r\n        message: error.message,\r\n      });\r\n    });\r\n  }\r\n};\r\n\r\nexport const uploadAvatar = (uri) => async (dispatch) => {\r\n  const fileRef = storage.child(uri);\r\n  await fileRef.putString(uri);\r\n  const avatarUrl = await fileRef.getDownloadURL();\r\n  dispatch({\r\n    type: UPLOAD_AVATAR,\r\n    payload: avatarUrl,\r\n  });\r\n};\r\n\r\n// Set or Update user in database and store\r\nexport const setUser = (user) => async (dispatch) => {\r\n  try {\r\n    if (getState().auth.userType === USER_TYPE.DOCTOR) {\r\n      await firestore\r\n        .collection(COLLECTION.DOCTOR)\r\n        .doc(getState().auth.user.id)\r\n        .set(user, { merge: true });\r\n    } else {\r\n      await firestore\r\n        .collection(COLLECTION.PATIENT)\r\n        .doc(getState().auth.user.id)\r\n        .set(user, { merge: true });\r\n    }\r\n\r\n    dispatch({\r\n      type: SET_USER,\r\n      payload: user,\r\n    });\r\n\r\n    return new Promise((res) =>\r\n      res({\r\n        status: \"success\",\r\n        message: \"Profile updated successfully\",\r\n      })\r\n    );\r\n  } catch (error) {\r\n    dispatch({\r\n      type: SET_ERROR,\r\n      payload: error.message,\r\n    });\r\n\r\n    return new Promise((res) =>\r\n      res({\r\n        status: \"error\",\r\n        message: error.message,\r\n      })\r\n    );\r\n  }\r\n};\r\n\r\n// Set user type in store\r\nexport const setUserType = (type) => (dispatch, getState) => {\r\n  dispatch({\r\n    type: SET_USER_TYPE,\r\n    payload: type,\r\n  });\r\n};\r\n\r\n// Set user state in store\r\nexport const setUserState = (user) => (dispatch) => {\r\n  dispatch({\r\n    type: SET_USER,\r\n    payload: user,\r\n  });\r\n};\r\n\r\n// Fetch hospital through UID\r\nexport const fetchHospitalData = (UID) => async (dispatch) => {\r\n  try {\r\n    dispatch({\r\n      type: SET_ISLOADING,\r\n      payload: true,\r\n    });\r\n\r\n    const getHospital = await firestore\r\n      .collection(\"hospitals\")\r\n      .where(\"UID\", \"==\", UID)\r\n      .get();\r\n\r\n    if (getHospital.size === 1) {\r\n      getHospital.forEach((doc) => {\r\n        dispatch({\r\n          type: FETCH_HOSPITAL_DATA,\r\n          payload: {\r\n            id: doc.id,\r\n            ...doc.data(),\r\n          },\r\n        });\r\n      });\r\n\r\n      return new Promise((res) =>\r\n        res({\r\n          status: \"success\",\r\n          message: \"Hospital details fetched successfully\",\r\n        })\r\n      );\r\n    } else {\r\n      // dispatch({\r\n      //   type: SET_ERROR,\r\n      //   payload: \"Hospital does not exist\",\r\n      // });\r\n      return new Promise((res, rej) =>\r\n        rej({\r\n          status: \"error\",\r\n          message: \"Hospital does not exist\",\r\n        })\r\n      );\r\n    }\r\n  } catch (e) {\r\n    // dispatch({\r\n    //   type: SET_ERROR,\r\n    //   payload: e.message,\r\n    // });\r\n\r\n    return new Promise((res, rej) =>\r\n      rej({\r\n        status: \"error\",\r\n        message: e.message,\r\n      })\r\n    );\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}